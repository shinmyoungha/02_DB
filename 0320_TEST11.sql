DROP TABLE TB_MEMBER;
DROP TABLE TB_GRADE;
DROP TABLE TB_AREA;


-- TB_MEMBER 테이블 생성


CREATE TABLE TB_MEMBER (
    MEMBER_ID VARCHAR2(20) PRIMARY KEY,
    MEMBER_PWD VARCHAR2(20) NOT NULL,
    MEMBER_NAME VARCHAR2(30) NOT NULL,
    GRADE VARCHAR2(10) NOT NULL,
    AREA_CODE VARCHAR2(10) NOT NULL
);

-- TB_MEMBER 데이터 삽입
INSERT INTO TB_MEMBER (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('hong01', 'pass01', '홍길동', '10', '02');
INSERT INTO TB_MEMBER (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('leess99', 'pass02', '이순신', '10', '032');
INSERT INTO TB_MEMBER (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('ss50000', 'pass03', '신사임당', '30', '031');
INSERT INTO TB_MEMBER (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('iu93', 'pass04', '아이유', '30', '02');
INSERT INTO TB_MEMBER (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('pcs1324', 'pass05', '박철수', '12', '031');
INSERT INTO TB_MEMBER (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('you_js', 'pass06', '유재석', '10', '02');
INSERT INTO TB_MEMBER (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE) VALUES ('kyh9876', 'pass07', '김영희', '20', '031');

SELECT * FROM TB_MEMBER;

-- TB_GRADE 테이블 생성
CREATE TABLE TB_GRADE (
    GRADE_CODE VARCHAR2(10) PRIMARY KEY,
    GRADE_NAME VARCHAR2(30) NOT NULL
);

-- TB_GRADE 데이터 삽입
INSERT INTO TB_GRADE (GRADE_CODE, GRADE_NAME) VALUES ('10', '일반회원');
INSERT INTO TB_GRADE (GRADE_CODE, GRADE_NAME) VALUES ('20', '우수회원');
INSERT INTO TB_GRADE (GRADE_CODE, GRADE_NAME) VALUES ('30', '특별회원');

SELECT * FROM TB_GRADE;

-- TB_AREA 테이블 생성
CREATE TABLE TB_AREA (
    AREA_CODE VARCHAR2(10) PRIMARY KEY,
    AREA_NAME VARCHAR2(30) NOT NULL
);

-- TB_AREA 데이터 삽입
INSERT INTO TB_AREA (AREA_CODE, AREA_NAME) VALUES ('02', '서울');
INSERT INTO TB_AREA (AREA_CODE, AREA_NAME) VALUES ('031', '경기');
INSERT INTO TB_AREA (AREA_CODE, AREA_NAME) VALUES ('032', '인천');

SELECT * FROM TB_AREA;


SELECT M.MEMBER_ID AS 아이디, 
       M.MEMBER_PWD AS 비밀번호, 
       M.MEMBER_NAME AS 이름, 
       G.GRADE_NAME AS 등급명, 
       A.AREA_NAME AS 지역명
FROM TB_MEMBER M
JOIN TB_GRADE G ON M.GRADE_CODE = G.GRADE_CODE
JOIN TB_AREA A ON M.AREA_CODE = A.AREA_CODE
WHERE (M.GRADE_CODE, M.AREA_CODE) = 
      (SELECT M2.GRADE_CODE, M2.AREA_CODE 
       FROM TB_MEMBER M2
       WHERE M2.MEMBER_ID LIKE '%1234%') 
ORDER BY M.MEMBER_ID DESC;​​

-- 검색해라 아이디 비번 이름 등급명
-- 멤버 테이블에서
-- 조인해라 자격 GRADE = GRADE_CODE 달라서 온 써야함
-- 컬럼명 같아서 유징 가능

아이디에 1234가 포함되는 회원과 같은 등급, 같은지역인 회원들의 아이디, 비밀번호, 이름, 등급명, 지역명을 아이디 내림차순으로 조회

[작성한 SQL]
SELECT MEMBER_ID AS 아이디, MEMBER_PWD 비밀번호, MEMBER_NAME AS 이름, GRADE_NAME AS 등급명
FROM TB_MEMBER
JOIN TB_GRADE USING(GRADE_CODE)
JOIN TB_AREA USING(AREA_CODE)
WHERE (GRADE, AREA_CODE) = 
    (SELECT GRADE, AREA_CODE FROM TB_MEMBER 멤버 테이블에서 지역코드와
    WHERE MEMBER_ID = '1234') 
ORDER BY MEMBER_ID DESC; ​


















SELECT A.AREA_NAME 지역명, M.MEMBER_ID 아이디, M.MEMBER_NAME 이름, G.GRADE_NAME 등급명
FROM TB_MEMBER M
JOIN TB_AREA A ON (A.AREA_CODE  = M.AREA_CODE)
JOIN TB_GRADE G ON(M.GRADE = G.GRADE_CODE)
WHERE A.AREA_CODE = (
    SELECT AREA_CODE FROM TB_MEMBER
    WHERE MEMBER_NAME = '김영희')
ORDER BY 이름;